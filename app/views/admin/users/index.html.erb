<% content_for :title, "User Management" %>

<div style="background: var(--sidebar-bg); border-radius: 1rem; border: 1px solid #334155; overflow: hidden;">
  <table style="width: 100%; border-collapse: collapse; text-align: left;">
    <thead>
      <tr style="border-bottom: 2px solid #334155; background: rgba(51, 65, 85, 0.2);">
        <th style="padding: 1.25rem 1.5rem; font-weight: 600;">Email Address</th>
        <th style="padding: 1.25rem 1.5rem; font-weight: 600;">Joined</th>
        <th style="padding: 1.25rem 1.5rem; font-weight: 600;">Role</th>
        <th style="padding: 1.25rem 1.5rem; font-weight: 600; text-align: right;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr style="border-bottom: 1px solid #1e293b; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.02)'" onmouseout="this.style.background='transparent'">
          <td style="padding: 1rem 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <div class="user-avatar" style="width: 32px; height: 32px; background-image: url('https://ui-avatars.com/api/?name=<%= user.email_address %>&background=random'); background-size: cover;"></div>
              <%= user.email_address %>
            </div>
          </td>
          <td style="padding: 1rem 1.5rem; color: var(--text-secondary); font-size: 0.875rem;">
            <%= user.created_at.strftime("%Y-%m-%d") %>
          </td>
          <td style="padding: 1rem 1.5rem;">
            <% if user.admin? %>
              <span style="background: rgba(236, 72, 153, 0.1); color: var(--accent-color); padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600;">Admin</span>
            <% else %>
              <span style="background: rgba(148, 163, 184, 0.1); color: var(--text-secondary); padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600;">User</span>
            <% end %>
          </td>
          <td style="padding: 1rem 1.5rem; text-align: right;">
            <% unless user.email_address == "root" || user == Current.session.user %>
              <%= link_to admin_user_path(user), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this user?" }, style: "color: #ef4444; font-size: 0.875rem; text-decoration: none;" do %>
                <i class="fas fa-trash-alt"></i> Delete
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
